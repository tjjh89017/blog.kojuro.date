<!doctype html><html lang=zh-TW><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Applied Micro X-Gene Mustang 使用心得 - 伊達's work</title><meta name=Description content><meta property="og:url" content="https://blog.kojuro.date/2021/02/2021-02-27-applied-micro-x-gene-mustang/"><meta property="og:site_name" content="伊達's work"><meta property="og:title" content="Applied Micro X-Gene Mustang 使用心得"><meta property="og:description" content="之前大學時期因為想玩玩 ARM64 Cloud 的緣故，所以找到了這台 Applied Micro 的 Mustang 原型機，可是大學時期一直沒有機會弄到一台 Mustang 來操作。直到最近廠商在清倉庫的時候，感謝 Richard Liu 直接幫我留了一台下來研究，而有這篇文章"><meta property="og:locale" content="zh_TW"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-02-27T10:37:42+00:00"><meta property="article:modified_time" content="2022-07-09T23:20:26+08:00"><meta property="og:image" content="https://blog.kojuro.date/logo.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.kojuro.date/logo.png"><meta name=twitter:title content="Applied Micro X-Gene Mustang 使用心得"><meta name=twitter:description content="之前大學時期因為想玩玩 ARM64 Cloud 的緣故，所以找到了這台 Applied Micro 的 Mustang 原型機，可是大學時期一直沒有機會弄到一台 Mustang 來操作。直到最近廠商在清倉庫的時候，感謝 Richard Liu 直接幫我留了一台下來研究，而有這篇文章"><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://blog.kojuro.date/2021/02/2021-02-27-applied-micro-x-gene-mustang/><link rel=prev href=https://blog.kojuro.date/2019/03/2019-03-20-too-many-cores-docker-problem/><link rel=next href=https://blog.kojuro.date/2021/08/2021-08-27-router-loopback-ip/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Applied Micro X-Gene Mustang 使用心得","inLanguage":"zh-TW","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.kojuro.date\/2021\/02\/2021-02-27-applied-micro-x-gene-mustang\/"},"image":["https:\/\/blog.kojuro.date\/images\/Apple-Devices-Preview.png"],"genre":"posts","wordcount":938,"url":"https:\/\/blog.kojuro.date\/2021\/02\/2021-02-27-applied-micro-x-gene-mustang\/","datePublished":"2021-02-27T10:37:42+00:00","dateModified":"2022-07-09T23:20:26+08:00","publisher":{"@type":"Organization","name":"xxxx","logo":"https:\/\/blog.kojuro.date\/images\/avatar.png"},"author":{"@type":"Person","name":"Date Huang"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="伊達's work">伊達's work</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/about/>About </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title=切換主題>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="伊達's work">伊達's work</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/about/ title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title=切換主題>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目錄</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Applied Micro X-Gene Mustang 使用心得</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Date Huang</a></span>&nbsp;<span class=post-category>收錄於 <a href=/categories/arm/><i class="far fa-folder fa-fw" aria-hidden=true></i>Arm</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2021-02-27>2021-02-27</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;約 938 字&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;預計閱讀 2 分鐘&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>目錄</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#flash-to-uefi-bootloader><span class=ez-toc-section id=Flash_to_UEFI_bootloader></span>Flash to UEFI bootloader<span class=ez-toc-section-end></span></a><ul><li><a href=#setup-mac-address><span class=ez-toc-section id=Setup_MAC_address></span>Setup MAC address<span class=ez-toc-section-end></span></a></li></ul></li><li><a href=#install-ubuntu-2004-arm64><span class=ez-toc-section id=Install_Ubuntu_2004_arm64></span>Install Ubuntu 20.04 arm64<span class=ez-toc-section-end></span></a><ul><li><a href=#flash-kernel-bug><span class=ez-toc-section id=flash-kernel_bug></span>flash-kernel bug<span class=ez-toc-section-end></span></a></li></ul></li><li><a href=#result><span class=ez-toc-section id=Result></span>Result<span class=ez-toc-section-end></span></a></li><li><a href=#reference><span class=ez-toc-section id=Reference></span>Reference<span class=ez-toc-section-end></span></a></li></ul></nav></div></div><div class=content id=content><p>之前大學時期因為想玩玩 ARM64 Cloud 的緣故，所以找到了這台 Applied Micro 的 Mustang 原型機，可是大學時期一直沒有機會弄到一台 Mustang 來操作。直到最近廠商在清倉庫的時候，感謝 Richard Liu 直接幫我留了一台下來研究，而有這篇文章</p><div id=ez-toc-container class="ez-toc-v2_0_17 counter-hierarchy counter-decimal ez-toc-grey"><div class=ez-toc-title-container><p class=ez-toc-title>Table of Contents</p><pre><code>&lt;span class=&quot;ez-toc-title-toggle&quot;&gt;&lt;a class=&quot;ez-toc-pull-right ez-toc-btn ez-toc-btn-xs ez-toc-btn-default ez-toc-toggle&quot; style=&quot;display: none;&quot;&gt;&lt;i class=&quot;ez-toc-glyphicon ez-toc-icon-toggle&quot;&gt;&lt;/i&gt;&lt;/a&gt;&lt;/span&gt;
</code></pre></div><nav><ul class="ez-toc-list ez-toc-list-level-1"><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-1" href=https://blog.kojuro.date/2021/02/applied-micro-x-gene-mustang-%e4%bd%bf%e7%94%a8%e5%bf%83%e5%be%97/#Flash_to_UEFI_bootloader title="Flash to UEFI bootloader">Flash to UEFI bootloader</a><ul class=ez-toc-list-level-3><li class=ez-toc-heading-level-3><a class="ez-toc-link ez-toc-heading-2" href=https://blog.kojuro.date/2021/02/applied-micro-x-gene-mustang-%e4%bd%bf%e7%94%a8%e5%bf%83%e5%be%97/#Setup_MAC_address title="Setup MAC address">Setup MAC address</a></li></ul></li><pre><code>&lt;li class=&quot;ez-toc-page-1 ez-toc-heading-level-2&quot;&gt;
  &lt;a class=&quot;ez-toc-link ez-toc-heading-3&quot; href=&quot;https://blog.kojuro.date/2021/02/applied-micro-x-gene-mustang-%e4%bd%bf%e7%94%a8%e5%bf%83%e5%be%97/#Install_Ubuntu_2004_arm64&quot; title=&quot;Install Ubuntu 20.04 arm64&quot;&gt;Install Ubuntu 20.04 arm64&lt;/a&gt;&lt;ul class=&quot;ez-toc-list-level-3&quot;&gt;
    &lt;li class=&quot;ez-toc-heading-level-3&quot;&gt;
      &lt;a class=&quot;ez-toc-link ez-toc-heading-4&quot; href=&quot;https://blog.kojuro.date/2021/02/applied-micro-x-gene-mustang-%e4%bd%bf%e7%94%a8%e5%bf%83%e5%be%97/#flash-kernel_bug&quot; title=&quot;flash-kernel bug&quot;&gt;flash-kernel bug&lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/li&gt;

&lt;li class=&quot;ez-toc-page-1 ez-toc-heading-level-2&quot;&gt;
  &lt;a class=&quot;ez-toc-link ez-toc-heading-5&quot; href=&quot;https://blog.kojuro.date/2021/02/applied-micro-x-gene-mustang-%e4%bd%bf%e7%94%a8%e5%bf%83%e5%be%97/#Result&quot; title=&quot;Result&quot;&gt;Result&lt;/a&gt;
&lt;/li&gt;
&lt;li class=&quot;ez-toc-page-1 ez-toc-heading-level-2&quot;&gt;
  &lt;a class=&quot;ez-toc-link ez-toc-heading-6&quot; href=&quot;https://blog.kojuro.date/2021/02/applied-micro-x-gene-mustang-%e4%bd%bf%e7%94%a8%e5%bf%83%e5%be%97/#Reference&quot; title=&quot;Reference&quot;&gt;Reference&lt;/a&gt;
&lt;/li&gt;
</code></pre></ul></nav></div><h2 id=flash-to-uefi-bootloader><span class=ez-toc-section id=Flash_to_UEFI_bootloader></span>Flash to UEFI bootloader<span class=ez-toc-section-end></span></h2><p>認識我的人應該都知道，我極度討厭 ARM 開發板上面的 U-boot 作為開機引導，U-boot 開機的方式太多種類了，導致每次拿到新的板子都要研究一番，就例如說：</p><ul><li>Raspberry Pi 1<ul><li>U-Boot 使用 kernel.img 作為名稱與格式</li></ul></li><li>ORDOID-XU4<ul><li>U-Boot 安裝在 SD 卡最前面的 sector，開機時會直接讀取 SD 卡作為開機引導，仿造 X86 BIOS 模式進行</li><li>U-Boot 需要指定 uImage 與 initrd.img</li></ul></li><li>Other ARM Board<ul><li>這就要看廠商用哪種模式了</li></ul></li></ul><p>所以 U-Boot 對我來說，是一個討厭到不行的存在，除了 Kernel 需要不同格式跟安裝方式，有時候還需要指定特定的記憶體位置把 Kernel 讀取進去，然後再開機。</p><p>感謝 Marcin Juszkiewicz 提供的教學 [<a href=https://marcin.juszkiewicz.com.pl/2015/11/18/unbricking-apm-mustang/ target=_blank rel="noopener noreffer">1</a>]<a href=https://marcin.juszkiewicz.com.pl/2015/11/18/unbricking-apm-mustang/ target=_blank rel="noopener noreffer">1</a> ，讓我可以把 Mustang 刷成 UEFI 開機的模式，而不需要浪費生命跟 U-Boot 戰鬥。請直接參閱 Marcin 提供的教學 blog，並且記得要同時更新 UEFI firmware 以及 Slimpro Firmware。</p><h3 id=setup-mac-address><span class=ez-toc-section id=Setup_MAC_address></span>Setup MAC address<span class=ez-toc-section-end></span></h3><p>發現更新完 UEFI，mac address 在每次開機的時候會填入隨機值，所以需要在 UEFI shell 中設定</p><pre class=wp-block-code><code>set MAC0 aa:bb:cc:dd:ee:f1
set MAC1 aa:bb:cc:dd:ee:f2
set MAC2 aa:bb:cc:dd:ee:f3
set MAC3 aa:bb:cc:dd:ee:f4</code></pre><p>需要把 mac address 替換成你機器上面的條碼編號，並依序遞增</p><h2 id=install-ubuntu-2004-arm64><span class=ez-toc-section id=Install_Ubuntu_2004_arm64></span>Install Ubuntu 20.04 arm64<span class=ez-toc-section-end></span></h2><p>安裝 Ubuntu 也是另外一個障礙，Ubuntu 有提供 arm64 安裝光碟，但是我發現 Live Installer 無法正常安裝，目前沒看到 log ，只有看到可能是 flash kernel 的時候遇到問題，目前猜可能是 Ubuntu 判定到是 APM-mustang 的機型之後，會認定使用 U-boot ，所以會順便使用 flash kernel 去安裝 Kernel 跟 DTB，所以 Live server 版本的安裝光碟無法使用。需要使用 Ubuntu arm64 netboot 的安裝 ISO [<a href=http://free.nchc.org.tw/ubuntu-ports/dists/focal/main/installer-arm64/current/legacy-images/ target=_blank rel="noopener noreffer">2</a>]<a href=http://free.nchc.org.tw/ubuntu-ports/dists/focal/main/installer-arm64/current/legacy-images/ target=_blank rel="noopener noreffer">2</a> ，連結2中的 mini.iso 可以使用來安裝，只是安裝過程中必須要連接網路，才有辦法透過網路安裝。直接將 mini.iso 透過 dd 或是 Win32diskimager 寫入隨身碟中，並且插入 Mustang ，執行以下指令就可以進入 Ubuntu 安裝畫面</p><pre class=wp-block-code><code>fsX:\efi\boot\bootaa64.efi</code></pre><p>請自行替換 fsX 成 UEFI 中你的隨身碟的代號</p><h3 id=flash-kernel-bug><span class=ez-toc-section id=flash-kernel_bug></span>flash-kernel bug<span class=ez-toc-section-end></span></h3><p>flash-kernel bug 經過一番 trace 之後發現很可能是因為 apm-mustang 過去一直都是 U-boot support，所以即便改成 UEFI 之後，flash-kernel 還是會認定需要透過 U-boot 方式開機。所以發了一個可能可以改善的 PR [<a href=https://salsa.debian.org/installer-team/flash-kernel/-/merge_requests/27 target=_blank rel="noopener noreffer">3</a>]<a href=https://salsa.debian.org/installer-team/flash-kernel/-/merge_requests/27 target=_blank rel="noopener noreffer">3</a></p><p>結果 flash-kernel bug 並不是 root cause，也不是 fatal error。這問題是 flash-kernel 行為，以及 APT 行為，再加上 Curtin 行為，三者一起才會發生影響的。等待跟開發者討論之後再來決定怎麼紀錄好了。</p><h2 id=result><span class=ez-toc-section id=Result></span>Result<span class=ez-toc-section-end></span><figure class=wp-block-image></h2><p><img loading=lazy width=1024 height=36 src=https://blog.kojuro.date/wp-content/uploads/2021/02/apm-mustang-uname-1024x36.png alt class=wp-image-188 srcset="https://blog.kojuro.date/wp-content/uploads/2021/02/apm-mustang-uname-1024x36.png 1024w, https://blog.kojuro.date/wp-content/uploads/2021/02/apm-mustang-uname-300x11.png 300w, https://blog.kojuro.date/wp-content/uploads/2021/02/apm-mustang-uname-768x27.png 768w, https://blog.kojuro.date/wp-content/uploads/2021/02/apm-mustang-uname.png 1114w" sizes="(max-width: 1024px) 100vw, 1024px"></figure><figure class=wp-block-image><img loading=lazy width=1024 height=573 src=https://blog.kojuro.date/wp-content/uploads/2021/02/apm-mustang-dmidecode-1024x573.png alt class=wp-image-187 srcset="https://blog.kojuro.date/wp-content/uploads/2021/02/apm-mustang-dmidecode-1024x573.png 1024w, https://blog.kojuro.date/wp-content/uploads/2021/02/apm-mustang-dmidecode-300x168.png 300w, https://blog.kojuro.date/wp-content/uploads/2021/02/apm-mustang-dmidecode-768x430.png 768w, https://blog.kojuro.date/wp-content/uploads/2021/02/apm-mustang-dmidecode.png 1115w" sizes="(max-width: 1024px) 100vw, 1024px"></figure><figure class=wp-block-image><img loading=lazy width=1024 height=573 src=https://blog.kojuro.date/wp-content/uploads/2021/02/apm-mustang-htop-1024x573.png alt class=wp-image-193 srcset="https://blog.kojuro.date/wp-content/uploads/2021/02/apm-mustang-htop-1024x573.png 1024w, https://blog.kojuro.date/wp-content/uploads/2021/02/apm-mustang-htop-300x168.png 300w, https://blog.kojuro.date/wp-content/uploads/2021/02/apm-mustang-htop-768x430.png 768w, https://blog.kojuro.date/wp-content/uploads/2021/02/apm-mustang-htop.png 1115w" sizes="(max-width: 1024px) 100vw, 1024px"></figure></p><h2 id=reference><span class=ez-toc-section id=Reference></span>Reference<span class=ez-toc-section-end></span></h2><ol><li><a href=https://marcin.juszkiewicz.com.pl/2015/11/18/unbricking-apm-mustang/ target=_blank rel="noopener noreffer">https://marcin.juszkiewicz.com.pl/2015/11/18/unbricking-apm-mustang/</a></li><li><a href=http://free.nchc.org.tw/ubuntu-ports/dists/focal/main/installer-arm64/current/legacy-images/ target=_blank rel="noopener noreffer">http://free.nchc.org.tw/ubuntu-ports/dists/focal/main/installer-arm64/current/legacy-images/</a></li><li><a href=https://salsa.debian.org/installer-team/flash-kernel/-/merge_requests/27 target=_blank rel="noopener noreffer">https://salsa.debian.org/installer-team/flash-kernel/-/merge_requests/27</a></li></ol></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新於 2022-07-09&nbsp;<a class=git-hash href=https://github.com/dillonzq/LoveIt/commit/2c653453dff7ea4c55a8d6fe89b3aee382d7a10a target=_blank title="commit by Date Huang(tjjh89017@hotmail.com) 2c653453dff7ea4c55a8d6fe89b3aee382d7a10a: upload wordpress posts">
<i class="fas fa-hashtag fa-fw" aria-hidden=true></i>2c65345</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/2021/02/2021-02-27-applied-micro-x-gene-mustang/index.md target=_blank>閱讀原始文檔</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=https://blog.kojuro.date/2021/02/2021-02-27-applied-micro-x-gene-mustang/ data-title="Applied Micro X-Gene Mustang 使用心得"><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://blog.kojuro.date/2021/02/2021-02-27-applied-micro-x-gene-mustang/><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Linkedin" data-sharer=linkedin data-url=https://blog.kojuro.date/2021/02/2021-02-27-applied-micro-x-gene-mustang/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主頁</a></span></section></div><div class=post-nav><a href=/2019/03/2019-03-20-too-many-cores-docker-problem/ class=prev rel=prev title="核心數太多導致的 Docker 問題"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>核心數太多導致的 Docker 問題</a>
<a href=/2021/08/2021-08-27-router-loopback-ip/ class=next rel=next title="Router Loopback IP使用">Router Loopback IP使用<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>由 <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.151.0">Hugo</a> 強力驅動 | 主題 - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022 - 2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank></a></span>&nbsp;|&nbsp;<span class=license>All Rights Reserved</span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到頂部><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title=查看評論><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"複製到剪貼板",maxShownLines:50},comment:{}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-1YYWDWN3ZY",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-1YYWDWN3ZY" async></script></body></html>